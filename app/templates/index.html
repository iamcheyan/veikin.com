{% extends "base.html" %}
{% block content %}
  {% set contact = site.get('contact', {}) %}
  <section class="hero signature">
    <div class="hero-intro">
      {% if site.hero.tagline %}
        <p class="hero-tagline">{{ site.hero.tagline }}</p>
      {% endif %}
      <h1 class="hero-title">{{ site.hero.title }}</h1>
      <p class="hero-subtitle">{{ site.hero.subtitle }}</p>
      <div class="hero-actions">
        {% set primary = site.hero.get('cta_primary', {}) %}
        {% if primary.label %}
          <a class="btn primary" href="{{ primary.url or ('/' ~ lang ~ '/works.html') }}">{{ primary.label }}</a>
        {% endif %}
        {% set secondary = site.hero.get('cta_secondary', {}) %}
        {% if secondary.label %}
          <a class="btn outline" href="{{ secondary.url or ('mailto:' ~ contact.email) }}">{{ secondary.label }}</a>
        {% endif %}
      </div>
      {% if site.hero.note %}
        <p class="hero-note">{{ site.hero.note }}</p>
      {% endif %}
    </div>
  </section>
  {% if site.highlights %}
    <section class="section highlights">
      <div class="highlight-grid">
        {% for item in site.highlights %}
          <div class="highlight-card">
            <span class="highlight-number">{{ '%02d' % loop.index }}</span>
            <h3>{{ item.title }}</h3>
            <p>{{ item.description }}</p>
          </div>
        {% endfor %}
      </div>
    </section>
  {% endif %}
  <section class="section works-preview">
    <div class="section-head">
      <h2 class="section-title">{{ t.section_works }}</h2>
      <a class="btn link" href="/{{ lang }}/works.html">{{ t.view_all }}</a>
    </div>

    {% set works_sorted = (site.works or []) | sort(attribute='date', reverse=True) %}
    {% set preview_works = works_sorted[:6] %}
    {% set tags = namespace(values=['all']) %}

    <div class="works-filter">
      <span class="filter-label">{{ t.filter_by_tag }}</span>
      <div class="filter-chips">
        <button class="chip filter-chip is-active" data-filter="all">{{ t.filter_all }}</button>
        {% for work in preview_works %}
          {% for tag in work.tags or [] %}
            {% if tag not in tags.values %}
              {% set tags.values = tags.values + [tag] %}
              <button class="chip filter-chip" data-filter="{{ tag }}">{{ tag }}</button>
            {% endif %}
          {% endfor %}
        {% endfor %}
      </div>
    </div>

    <div class="grid works" data-works-grid>
      {% for work in preview_works %}
        <a class="card glass lift work-card" href="{{ work.url }}" target="_blank" rel="noopener" data-work-tags="{{ (work.tags or []) | join('|') }}">
          <img src="{{ work.image | asset_url }}" alt="{{ work.title }}"/>
          <div class="card-body">
            {% if work.date %}
              <div class="work-card-meta">
                <time class="work-card-date" datetime="{{ work.date }}">{{ work.date }}</time>
              </div>
            {% endif %}
            <h3>{{ work.title }}</h3>
            <p>{{ work.description }}</p>
            {% if work.tags %}
              <div class="chips">
                {% for tag in work.tags %}
                  <span class="chip sm">{{ tag }}</span>
                {% endfor %}
              </div>
            {% endif %}
          </div>
        </a>
      {% endfor %}

      <!-- 空状态 -->
      <div class="works-empty" data-filter-empty style="display: none;">
        {{ t.filter_no_results }}
      </div>
    </div>
  </section>
{% endblock %}
